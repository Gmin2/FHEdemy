:root {
  --bg: #070b14;
  --bg2: #050811;
  --panel: rgba(16, 22, 40, 0.6);
  --border: #1b2240;
  --text: #e9eefc;
  --muted: #9ba6c9;
  --primary: #78a6ff;
  --accent: #ff5b9d;
  --lime: #7dffb3;
  --highlight: rgba(120, 166, 255, 0.22);
  --glow: 0 0 40px rgba(120, 166, 255, 0.35), 0 0 80px rgba(120, 166, 255, 0.18);
}

* { box-sizing: border-box; }
html, body, #root { height: 100%; margin: 0; }
body { background: radial-gradient(1200px 700px at 70% 10%, #0c1224 0%, var(--bg) 45%, var(--bg2) 100%); color: var(--text); font-family: 'Space Grotesk', ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial; }

/* HERO */
.page { min-height: 100%; }
.hero { position: relative; padding: 72px 24px 40px; text-align: center; overflow: hidden; }
.hero.minimal { padding-bottom: 12px; }
.hero.home { padding: 96px 24px 48px; }
.title { font-size: 54px; font-weight: 900; letter-spacing: .02em; margin: 0 0 6px; }
.subtitle { color: var(--muted); margin: 0 0 14px; }
.cta-row { display: flex; gap: 12px; justify-content: center; }
.ring { position: absolute; left: 50%; top: 0; width: 1400px; height: 1400px; transform: translateX(-50%); border-radius: 50%; background: radial-gradient(closest-side, rgba(120,166,255,.18), rgba(255,91,157,.12), transparent 70%); filter: blur(60px); opacity: .5; }
.ring-1 { top: -820px; }
.ring-2 { top: -860px; transform: translateX(-40%); opacity: .35; }
.glitch-wrap { position: relative; display: inline-block; }
.glitch { font-size: 56px; letter-spacing: 2px; font-weight: 800; text-transform: uppercase; position: relative; display: inline-block; filter: drop-shadow(0 8px 28px rgba(0,0,0,0.6)); }
.glitch:before, .glitch:after { content: attr(data-text); position: absolute; left: 0; top: 0; width: 100%; height: 100%; }
.glitch:before { color: #ff3358; transform: translate(2px, 0); mix-blend-mode: screen; opacity: .85; animation: jitter 2s infinite ease-in-out; }
.glitch:after { color: #44ffee; transform: translate(-2px, 0); mix-blend-mode: screen; opacity: .85; animation: jitter 2.2s infinite ease-in-out reverse; }
.logo-ghost { position: absolute; left: -64px; top: -12px; width: 48px; height: 48px; background: linear-gradient(135deg, #ffd36a, #ff7bb6); border-radius: 14px 14px 20px 20px; box-shadow: var(--glow); filter: saturate(1.2) contrast(1.1); }
.tag { margin-top: 8px; color: var(--muted); opacity: .9; }
.hero-actions { margin-top: 18px; display: flex; gap: 12px; justify-content: center; }
.cta { padding: 10px 16px; border-radius: 12px; background: linear-gradient(135deg, var(--primary), #9ad0ff); color: #05122e; font-weight: 700; text-decoration: none; border: 1px solid #2a5bd6; box-shadow: var(--glow); }
.cta.secondary { background: rgba(20, 26, 54, 0.7); color: var(--text); border: 1px solid var(--border); box-shadow: inset 0 0 0 1px rgba(255,255,255,0.05); }

/* Film grain & scanlines overlays */
.fx { pointer-events: none; position: absolute; inset: 0; }
.grain { opacity: .08; background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.90" numOctaves="2" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23n)" opacity="1"/></svg>'); background-size: 320px; mix-blend-mode: overlay; }
.scanlines { background: repeating-linear-gradient(0deg, rgba(255,255,255,.05) 0px, rgba(255,255,255,.05) 1px, transparent 3px, transparent 4px); opacity: .06; }

/* LAYOUT */
.stage { position: relative; max-width: 1920px; margin: 0 auto; padding: 24px; min-height: calc(100vh - 220px); display: grid; grid-template-columns: 1fr 550px; grid-template-areas: 'canvas dock'; gap: 18px; align-items: start; }
.stage.has-rail { grid-template-columns: 320px 1fr 520px; grid-template-areas: 'rail canvas dock'; }
.rail { grid-area: rail; position: sticky; top: 72px; border-radius: 14px; border: 1px solid rgba(140,160,220,.15); background: var(--panel); padding: 14px; backdrop-filter: blur(12px) saturate(1.2); }

/* Dropdown sections for tutorial steps */
.section-group { margin-bottom: 8px; }
.section-header { width: 100%; text-align: left; position: relative; padding-right: 28px; }
.expand-icon { 
  position: absolute; 
  right: 12px; 
  top: 50%; 
  transform: translateY(-50%) rotate(0deg); 
  transition: transform 0.2s ease; 
  font-size: 12px; 
  color: var(--muted);
}
.expand-icon.expanded { transform: translateY(-50%) rotate(180deg); }
.subsections { margin-left: 16px; margin-top: 4px; }
.subsection { 
  width: calc(100% - 16px); 
  margin-bottom: 2px; 
  background: rgba(255,255,255,0.03); 
  border: 1px solid rgba(255,255,255,0.08);
  font-size: 13px;
  padding: 8px 12px;
}
.sub-num { 
  color: var(--muted); 
  font-size: 11px; 
  margin-right: 8px; 
}
.canvas { grid-area: canvas; }
.dock { grid-area: dock; position: sticky; top: 84px; height: calc(100vh - 120px); border-radius: 16px; overflow: hidden; border: 1px solid rgba(140,160,220,.2); background: rgba(10,14,28,.8); backdrop-filter: blur(16px) saturate(1.3); box-shadow: 0 30px 80px rgba(7,11,20,.6); }
.topnav { position: sticky; top: 0; z-index: 20; display: flex; align-items: center; justify-content: space-between; padding: 12px 18px; background: rgba(6, 10, 20, .6); backdrop-filter: blur(12px); border-bottom: 1px solid rgba(140,160,220,.15); }
.brand { font-weight: 800; letter-spacing: .08em; display: flex; align-items: center; gap: 10px; }
.brand .dot { width: 10px; height: 10px; border-radius: 50%; background: linear-gradient(135deg, var(--accent), var(--primary)); box-shadow: var(--glow); display: inline-block; }
.nav-actions { display: flex; gap: 10px; }
.nav-link { color: var(--text); text-decoration: none; font-weight: 600; padding: 6px 10px; border-radius: 10px; border: 1px solid transparent; }
.nav-link:hover { border-color: rgba(140,160,220,.3); background: rgba(15,22,42,.5); }

/* Route sections */
.route { max-width: 1200px; margin: 0 auto; padding: 0 16px 24px; }
.home-sections { display: grid; grid-template-columns: repeat(3, 1fr); gap: 14px; padding: 8px 4px 20px; }
.feature { display: flex; gap: 12px; align-items: flex-start; border: 1px solid var(--border); border-radius: 14px; padding: 16px; background: rgba(14,20,40,.75); backdrop-filter: blur(10px); box-shadow: 0 10px 26px rgba(12,18,45,.25); }
.icon { width: 36px; height: 36px; display: grid; place-items: center; font-size: 20px; border-radius: 12px; background: linear-gradient(135deg, var(--primary), var(--accent)); color: #06122a; font-weight: 800; }
.home-actions { display: grid; grid-template-columns: repeat(2, 1fr); gap: 14px; padding: 4px; }
.action-card { display: block; border: 1px solid var(--border); border-radius: 16px; padding: 18px; background: linear-gradient(180deg, rgba(13, 19, 42, 0.8), rgba(9, 14, 30, 0.85)); text-decoration: none; color: var(--text); box-shadow: 0 14px 34px rgba(12,18,45,.28); }
.action-card:hover { border-color: #2a5bd6; box-shadow: 0 18px 42px rgba(30,70,200,.25); }
.action-title { font-weight: 900; letter-spacing: .02em; margin-bottom: 6px; }

/* Steps */
.steps { display: flex; flex-direction: column; gap: 10px; }
.step { padding: 12px; border: 1px solid var(--border); border-radius: 12px; background: rgba(10, 16, 36, 0.8); cursor: pointer; transition: transform .12s ease, box-shadow .12s ease, border-color .12s; }
.step:hover { border-color: #2a5bd6; box-shadow: 0 8px 26px rgba(30, 70, 200, .18); transform: translateY(-1px); }
.step-title { font-weight: 700; letter-spacing: .02em; }
.step-desc { font-size: 12px; color: var(--muted); }

/* Story */
.story { display: grid; grid-template-columns: 280px 1fr; gap: 20px; }
.story-rail { display: flex; flex-direction: column; gap: 10px; }
.pill { display: flex; align-items: center; gap: 10px; background: rgba(10,16,36,.7); border: 1px solid var(--border); border-radius: 999px; padding: 10px 14px; color: var(--text); cursor: pointer; text-align: left; }
.pill .num { display: inline-flex; align-items: center; justify-content: center; width: 24px; height: 24px; border-radius: 999px; background: linear-gradient(135deg, var(--accent), var(--primary)); color: #041025; font-weight: 800; }
.pill.active { border-color: #2a5bd6; box-shadow: 0 8px 26px rgba(30,70,200,.18); }
.story-pane { border: 1px solid var(--border); border-radius: 16px; background: rgba(10,14,28,.75); padding: 20px; backdrop-filter: blur(12px); max-height: calc(100vh - 120px); display: flex; flex-direction: column; }
.story-header { display: flex; align-items: center; gap: 16px; margin-bottom: 16px; }
.story-title { font-weight: 800; letter-spacing: .02em; }
.story-progress { flex: 1; height: 8px; border-radius: 999px; background: rgba(255,255,255,.06); overflow: hidden; }
.story-progress .bar { height: 100%; background: linear-gradient(90deg, var(--primary), var(--accent)); }
.story-content { flex: 1; overflow-y: auto; padding-right: 8px; }
.story-content::-webkit-scrollbar { width: 8px; }
.story-content::-webkit-scrollbar-track { background: rgba(255,255,255,.05); border-radius: 4px; }
.story-content::-webkit-scrollbar-thumb { background: rgba(255,255,255,.15); border-radius: 4px; }
.story-content::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,.25); }
.story-actions { display: flex; justify-content: flex-end; gap: 8px; margin-top: 16px; padding-top: 16px; border-top: 1px solid rgba(255,255,255,.08); }

/* Markdown Content Styling */
.markdown-body { color: var(--text); line-height: 1.7; }
.markdown-body h1 { font-size: 28px; font-weight: 800; margin: 24px 0 16px 0; color: var(--text); letter-spacing: .02em; border-bottom: 2px solid rgba(255,255,255,.1); padding-bottom: 10px; }
.markdown-body h2 { font-size: 22px; font-weight: 700; margin: 20px 0 12px 0; color: var(--text); letter-spacing: .02em; }
.markdown-body h3 { font-size: 18px; font-weight: 600; margin: 16px 0 10px 0; color: var(--text); }
.markdown-body h4 { font-size: 16px; font-weight: 600; margin: 14px 0 8px 0; color: var(--muted); }
.markdown-body p { margin: 12px 0; color: var(--muted); }
.markdown-body hr { border: none; border-top: 1px solid rgba(255,255,255,.1); margin: 24px 0; }
.markdown-body ul, .markdown-body ol { margin: 12px 0; padding-left: 24px; color: var(--muted); }
.markdown-body li { margin: 6px 0; }
.markdown-body strong { color: var(--text); font-weight: 700; }
.markdown-body em { color: var(--accent); font-style: italic; }
.markdown-body code { background: rgba(30,70,200,.15); padding: 2px 6px; border-radius: 4px; font-family: 'JetBrains Mono', monospace; font-size: 13px; color: #9ad0ff; border: 1px solid rgba(30,70,200,.25); }
.markdown-body pre { background: #0b1222; border: 1px solid var(--border); border-radius: 12px; padding: 16px; margin: 16px 0; overflow-x: auto; box-shadow: inset 0 0 0 1px rgba(255,255,255,.03); }
.markdown-body pre code { background: none; padding: 0; border: none; color: #d4e3fc; font-size: 13px; display: block; }
.markdown-body blockquote { border-left: 3px solid var(--primary); padding-left: 16px; margin: 16px 0; color: var(--muted); font-style: italic; background: rgba(30,70,200,.08); padding: 12px 16px; border-radius: 0 8px 8px 0; }
.markdown-body a { color: var(--accent); text-decoration: none; border-bottom: 1px solid transparent; }
.markdown-body a:hover { border-bottom-color: var(--accent); }
.markdown-body table { width: 100%; border-collapse: collapse; margin: 16px 0; }
.markdown-body th, .markdown-body td { padding: 10px 12px; border: 1px solid var(--border); text-align: left; }
.markdown-body th { background: rgba(255,255,255,.05); font-weight: 700; color: var(--text); }
.markdown-body td { color: var(--muted); }

/* Special markdown hints ({% hint %}) */
.markdown-body p:has(code:first-child) { color: var(--text); }
.markdown-body p > code { background: rgba(120,166,255,.15); }

/* Hint Boxes */
.hint-box {
  display: flex;
  gap: 12px;
  padding: 14px 16px;
  border-radius: 10px;
  margin: 16px 0;
  border-left: 4px solid;
  background: rgba(10,16,36,.4);
  backdrop-filter: blur(8px);
  box-shadow: 0 4px 12px rgba(0,0,0,.2);
}
.hint-icon {
  font-size: 20px;
  line-height: 1;
  flex-shrink: 0;
}
.hint-content {
  flex: 1;
  color: var(--text);
  line-height: 1.6;
}
.hint-content p { margin: 0; }
.hint-warning {
  border-color: #ffaa00;
  background: rgba(255, 170, 0, 0.08);
}
.hint-warning .hint-icon {
  color: #ffaa00;
}
.hint-warning .hint-content {
  color: #ffdd88;
}
.hint-info {
  border-color: #1e90ff;
  background: rgba(30, 144, 255, 0.08);
}
.hint-info .hint-icon {
  color: #1e90ff;
}
.hint-info .hint-content {
  color: #9ad0ff;
}

/* Playground */
.playground { display: flex; flex-direction: column; gap: 12px; height: 100%; }
.toolbar { display: flex; align-items: center; gap: 8px; }
.spacer { flex: 1; }
.hint { color: var(--muted); font-size: 12px; }

.card { position: relative; border: 1px solid var(--border); border-radius: 14px; padding: 14px; background: linear-gradient(180deg, rgba(13, 19, 42, 0.9), rgba(9, 14, 30, 0.9)); box-shadow: 0 10px 30px rgba(12,18,45,.25) inset, 0 0 0 1px rgba(255,255,255,.02) inset; }
.card:after { content: ""; position: absolute; inset: 0; border-radius: 14px; pointer-events: none; background: radial-gradient(600px 160px at 20% -20%, rgba(120,166,255,.25), transparent 50%), radial-gradient(600px 160px at 120% 120%, rgba(255,91,157,.25), transparent 40%); opacity: .7; }
.card.info { color: var(--muted); font-size: 14px; }
.row { display: flex; gap: 10px; align-items: center; margin-top: 8px; }
.row.result { justify-content: space-between; }
.stat .label { font-size: 12px; color: var(--muted); }
.stat .value { font-size: 22px; font-weight: 800; letter-spacing: .02em; }

label { width: 90px; color: var(--muted); font-size: 13px; }
input { flex: 1; padding: 10px 12px; border-radius: 12px; border: 1px solid var(--border); background: #0b1222; color: var(--text); box-shadow: inset 0 0 0 1px rgba(255,255,255,.03); }

.btn { border: 1px solid var(--border); background: linear-gradient(135deg, #18264e, #1a2a56); color: var(--text); padding: 10px 14px; border-radius: 12px; cursor: pointer; transition: transform .12s ease, box-shadow .12s ease; box-shadow: 0 8px 22px rgba(12,18,45,.25); }
.btn:hover { transform: translateY(-1px); box-shadow: 0 12px 28px rgba(12,18,45,.35); }
.btn.primary { background: linear-gradient(135deg, var(--primary), #9ad0ff); color: #06102a; border-color: #2f5fb8; }
.btn.secondary { background: linear-gradient(135deg, #173a1a, #205522); border-color: #2b7730; }
.btn:disabled { opacity: 0.5; cursor: not-allowed; }

/* Code Explorer */
.code-explorer { display: flex; flex-direction: column; height: 100%; }
.code-header { display: flex; align-items: center; justify-content: space-between; padding: 8px 10px; border-bottom: 1px solid var(--border); }
.code-editor { flex: 1; }
.monaco-editor, .monaco-editor * { font-family: 'JetBrains Mono', ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace !important; }

/* Monaco line highlight hook */
.monaco-editor .view-overlays .current-line ~ .line-decoration,
.code-highlight { background: var(--highlight); }

/* GitBook Hint Boxes */
.hint {
  margin: 16px 0;
  padding: 14px 16px;
  border-radius: 12px;
  border-left: 4px solid;
  background: rgba(20, 26, 54, 0.5);
  backdrop-filter: blur(8px);
}

.hint-info {
  border-left-color: var(--primary);
  background: rgba(120, 166, 255, 0.1);
}

.hint-warning {
  border-left-color: #ffd36a;
  background: rgba(255, 211, 106, 0.1);
}

.hint-danger {
  border-left-color: #ff5b5b;
  background: rgba(255, 91, 91, 0.1);
}

.hint-success {
  border-left-color: var(--lime);
  background: rgba(125, 255, 179, 0.1);
}

.hint p:first-child {
  margin-top: 0;
}

.hint p:last-child {
  margin-bottom: 0;
}

/* Animations */
@keyframes jitter { 0%{ transform: translate(2px,0)} 20%{ transform: translate(-1px,0)} 40%{ transform: translate(1px,0)} 60%{ transform: translate(-2px,0)} 80%{ transform: translate(1px,0)} 100%{ transform: translate(2px,0)} }

@media (max-width: 1200px) {
  .rail { position: static; max-width: none; margin-bottom: 12px; }
  .stage { grid-template-columns: 1fr; grid-template-areas: 'canvas' 'dock'; }
  .dock { position: static; width: 100%; height: 60vh; margin-top: 12px; }
  .home-sections { grid-template-columns: 1fr; }
  .story { grid-template-columns: 1fr; }
}
